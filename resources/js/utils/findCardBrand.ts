export function findCardBrand(digits: string): string | null {
	if (!digits) {
		return null;
	}

	const cleanDigits = digits.replace(/\D/g, '');

	const patterns = {
		amex: /^3[47][0-9]{13}$/,
		diners: /^3(?:0[0-5]|[68][0-9])[0-9]{11}$/,
		discover:
			/^(?:6011[0-9]{12}|65[4-9][0-9]{13}|64[4-9][0-9]{13}|622(?:12[6-9]|1[3-9][0-9]|[2-8][0-9]{2}|9(?:0[0-1][0-9]|2[0-5]))[0-9]{10})$/,
		elo: /^(?:401178|401179|431274|438935|451416|457393|457631|457632|504175|627780|636297|636368|636369)[0-9]{10}$/,
		hipercard: /^(?:606282[0-9]{10}(?:[0-9]{3})?|3841[0-9]{2}[0-9]{10})$/,
		maestro: /^(?:5018|5020|5038|5893|6304|6759|6761|6762|6763)[0-9]{8,15}$/,
		mastercard:
			/^(?:5[1-5][0-9]{14}|2(?:2[2-9][0-9]{2}|[3-6][0-9]{3}|7(?:0[0-1][0-9]|20))[0-9]{12})$/,
		visa: /^4[0-9]{12}(?:[0-9]{3})?(?:[0-9]{3})?$/,
	};

	for (const [brand, pattern] of Object.entries(patterns)) {
		if (pattern.test(cleanDigits)) {
			return brand;
		}
	}

	return null;
}
